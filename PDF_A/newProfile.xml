<ns2:profile flavour="PDFA_1_B" creator="veraPDF Consortium" created="2015-09-30T13:11:23+01:00" xmlns:ns2="http://www.verapdf.org/ValidationProfile">
    <name>PDF/A-1B validation profile</name>
    <description>Validation rules against ISO 19005-1:2005, Cor.1:2007 and Cor.2:2011</description>
    <rules>
        <rules object="PDDeviceGray">
            <id specifcation="ISO_19005_1" clause="6.2.3" testNumber="4"/>
            <description>If an uncalibrated colour space is used in a file then that file shall contain a PDF/A-1 OutputIntent, as defined in 6.2.2</description>
            <test>gOutputCS != null</test>
            <references/>
        </rules>
        <rules object="CosDict">
            <id specifcation="ISO_19005_1" clause="6.1.12" testNumber="6"/>
            <description>Maximum capacity of a dictionary (in entries) is 4095</description>
            <test>size &lt;= 4095</test>
            <references>
                <references specification="PDF Reference 1.4" clause="Table C.1"/>
            </references>
        </rules>
        <rules object="CosArray">
            <id specifcation="ISO_19005_1" clause="6.1.12" testNumber="5"/>
            <description>Maximum capacity of an array (in elements) is 8191</description>
            <test>size &lt;= 8191</test>
            <references>
                <references specification="PDF Reference 1.4" clause="Table C.1"/>
            </references>
        </rules>
        <rules object="PDFormField">
            <id specifcation="ISO_19005_1" clause="6.6.2" testNumber="2"/>
            <description>A Field dictionary shall not include an AA entry for an additional-actions dictionary</description>
            <test>AA_size == 0</test>
            <references/>
        </rules>
        <rules object="PDXObject">
            <id specifcation="ISO_19005_1" clause="6.4" testNumber="2"/>
            <description>An XObject dictionary shall not contain the SMask key</description>
            <test>SMask_size == 0</test>
            <references>
                <references specification="ISO19005-1:2005/Cor.2:2011" clause="6.4"/>
            </references>
        </rules>
        <rules object="PDFont">
            <id specifcation="ISO_19005_1" clause="6.3.2" testNumber="3"/>
            <description>All fonts used in a conforming file shall conform to the font specifications defined in PDF Reference 5.5.
			BaseFont - name - (Required) The PostScript name of the font</description>
            <test>Subtype == "Type3" || BaseFont != null</test>
            <references>
                <references specification="PDF 1.4 Reference" clause="5.5.1 - Table 5.8"/>
                <references specification="PDF 1.4 Reference" clause="5.5.4 - Table 5.9"/>
                <references specification="PDF 1.4 Reference" clause="5.6.3 - Table 5.13"/>
                <references specification="PDF 1.4 Reference" clause="5.6.5 - Table 5.17"/>
            </references>
        </rules>
        <rules object="PDTrueTypeFont">
            <id specifcation="ISO_19005_1" clause="6.3.7" testNumber="2"/>
            <description>All symbolic TrueType fonts shall not specify an Encoding entry in the font dictionary</description>
            <test>isSymbolic == false || Encoding == null</test>
            <references>
                <references specification="ISO19005-1:2005/Cor.2:2011" clause="6.3.7"/>
            </references>
        </rules>
        <rules object="PDDeviceN">
            <id specifcation="ISO_19005_1" clause="6.1.12" testNumber="9"/>
            <description>Maximum number of DeviceN components is 8</description>
            <test>nrComponents &lt;= 8</test>
            <references>
                <references specification="PDF Reference 1.4" clause="Table C.1"/>
            </references>
        </rules>
        <rules object="PDOutputIntent">
            <id specifcation="ISO_19005_1" clause="6.2.2" testNumber="2"/>
            <description>If a file's OutputIntents array contains more than one entry, then all entries that contain a DestOutputProfile
			key shall have as the value of that key the same indirect object, which shall be a valid ICC profile stream</description>
            <test>destOutputProfileRef == null || gOutputProfileRef == null || destOutputProfileRef == gOutputProfileRef</test>
            <references/>
        </rules>
        <rules object="XMPMainPackage">
            <id specifcation="ISO_19005_1" clause="6.7.11" testNumber="1"/>
            <description>The PDF/A version and conformance level of a file shall be specified using the PDF/A Identification extension schema.</description>
            <test>ispdfaidNSPresent</test>
            <references/>
        </rules>
        <rules object="PDExtGState">
            <id specifcation="ISO_19005_1" clause="6.4" testNumber="5"/>
            <description>The following keys, if present in an ExtGState object, shall have the values shown: CA - 1.0</description>
            <test>CA == null || CA - 1.0 &lt; 0.000001 &amp;&amp; CA - 1.0 &gt; -0.000001</test>
            <references/>
        </rules>
        <rules object="PDFAIdSchema">
            <id specifcation="ISO_19005_1" clause="6.7.11" testNumber="5"/>
            <description>The PDF/A Identification Schema has required prefix "pdfaid".</description>
            <test>prefix == "pdfaid"</test>
            <references/>
        </rules>
        <rules object="CosRenderingIntent">
            <id specifcation="ISO_19005_1" clause="6.2.9" testNumber="1"/>
            <description>Where a rendering intent is specified, its value shall be one of the four values defined in PDF Reference
			RelativeColorimetric, AbsoluteColorimetric, Perceptual or Saturation</description>
            <test>value == "RelativeColorimetric" || value == "AbsoluteColorimetric" || value == "Perceptual" || value == "Saturation"</test>
            <references/>
        </rules>
        <rules object="CIDGlyph">
            <id specifcation="ISO_19005_1" clause="6.1.12" testNumber="10"/>
            <description>Maximum value of a CID (character identifier) is 65,535</description>
            <test>CID &lt;= 65535</test>
            <references>
                <references specification="PDF Reference 1.4" clause="Table C.1"/>
            </references>
        </rules>
        <rules object="CosDocument">
            <id specifcation="ISO_19005_1" clause="6.1.13" testNumber="1"/>
            <description>The document catalog dictionary shall not contain a key with the name OCProperties</description>
            <test>isOptionalContentPresent == false</test>
            <references/>
        </rules>
        <rules object="PDType1Font">
            <id specifcation="ISO_19005_1" clause="6.3.5" testNumber="2"/>
            <description>For all Type 1 font subsets referenced within a conforming file, the font descriptor dictionary shall include a CharSet string
			listing the character names defined in the font subset, as described in PDF Reference Table 5.18</description>
            <test>BaseFont.search(/[A-Z]{6}\+/) != 0 || CharSet != null</test>
            <references>
                <references specification="PDF 1.4 Reference" clause="5.5.3"/>
            </references>
        </rules>
        <rules object="PDXImage">
            <id specifcation="ISO_19005_1" clause="6.2.4" testNumber="3"/>
            <description>If an Image dictionary contains the Interpolate key, its value shall be false</description>
            <test>Interpolate == false</test>
            <references/>
        </rules>
        <rules object="PDFAIdSchema">
            <id specifcation="ISO_19005_1" clause="6.7.11" testNumber="3"/>
            <description>The PDF/A version and conformance level of a file shall be specified using the PDF/A Identification extension schema.</description>
            <test>conformance == "B"</test>
            <references/>
        </rules>
        <rules object="Glyph">
            <id specifcation="ISO_19005_1" clause="6.3.5" testNumber="1"/>
            <description>Embedded font programs shall define all font glyphs referenced for rendering with a conforming file</description>
            <test>isGlyphPresent == true</test>
            <references/>
        </rules>
        <rules object="PDMetadata">
            <id specifcation="ISO_19005_1" clause="6.7.2" testNumber="2"/>
            <description>Metadata object stream dictionaries shall not contain the Filter key.</description>
            <test>Filter == null</test>
            <references/>
        </rules>
        <rules object="CosName">
            <id specifcation="ISO_19005_1" clause="6.1.12" testNumber="4"/>
            <description>Maximum length of a name (in bytes) is 127</description>
            <test>origLength &lt;= 127</test>
            <references>
                <references specification="PDF Reference 1.4" clause="Table C.1"/>
            </references>
        </rules>
        <rules object="XMPPackage">
            <id specifcation="ISO_19005_1" clause="6.7.5" testNumber="1"/>
            <description>The bytes attribute shall not be used in the header of an XMP packet.</description>
            <test>bytes == null</test>
            <references/>
        </rules>
        <rules object="PDAction">
            <id specifcation="ISO_19005_1" clause="6.6.1" testNumber="1"/>
            <description>The Launch, Sound, Movie, ResetForm, ImportData and JavaScript actions shall not be permitted.
			Additionally, the deprecated set-state and no-op actions shall not be permitted. The Hide action shall not be permitted (Corrigendum 2)</description>
            <test>S == "GoTo" || S == "GoToR" || S == "Thread" || S == "URI" || S == "Named" || S == "SubmitForm"</test>
            <references>
                <references specification="ISO19005-1:2005/Cor.2:2011" clause="6.6.1"/>
            </references>
        </rules>
        <rules object="XMPPredefinedSchema">
            <id specifcation="ISO_19005_1" clause="6.7.9" testNumber="3"/>
            <description>All predefined schemas shall conform to XMP specification.</description>
            <test>wrongValueTypeProperties == null</test>
            <references>
                <references specification="XMP Specification January 2004"/>
            </references>
        </rules>
        <rules object="XMPPackage">
            <id specifcation="ISO_19005_1" clause="6.7.9" testNumber="1"/>
            <description>The metadata stream shall conform to XMP Specification.</description>
            <test>isMetadataValid</test>
            <references>
                <references specification="XMP Specification January 2004"/>
            </references>
        </rules>
        <rules object="PDFormField">
            <id specifcation="ISO_19005_1" clause="6.9" testNumber="3"/>
            <description>A Widget annotation dictionary or Field dictionary shall not contain the A or AA keys</description>
            <test>AA_size == 0</test>
            <references/>
        </rules>
        <rules object="PDTrueTypeFont">
            <id specifcation="ISO_19005_1" clause="6.3.7" testNumber="1"/>
            <description>All non-symbolic TrueType fonts shall specify MacRomanEncoding or WinAnsiEncoding, either as the value of the Encoding entry in the font dictionary
			or as the value of the BaseEncoding entry in the dictionary that is the value of the Encoding entry in the font dictionary.
			If the value of the Encoding entry is a dictionary, it shall not contain a Differences entry.</description>
            <test>isSymbolic == true || (Encoding == "MacRomanEncoding" || Encoding == "WinAnsiEncoding")</test>
            <references>
                <references specification="ISO19005-1:2005/Cor.2:2011" clause="6.3.7"/>
            </references>
        </rules>
        <rules object="CosDocument">
            <id specifcation="ISO_19005_1" clause="6.1.3" testNumber="3"/>
            <description>No data shall follow the last end-of-file marker except a single optional end-of-line marker.</description>
            <test>eofCompliesPDFA</test>
            <references/>
        </rules>
        <rules object="PDCMap">
            <id specifcation="ISO_19005_1" clause="6.3.3" testNumber="3"/>
            <description>All CMaps used within a conforming file, except Identity-H and Identity-V, shall be embedded in that file as described in PDF Reference 5.6.4</description>
            <test>CMapName == "Identity-H" || CMapName == "Identity-V" || embeddedFile_size == 1</test>
            <references>
                <references specification="PDF 1.4 Reference" clause="5.6.4"/>
            </references>
        </rules>
        <rules object="XMPPackage">
            <id specifcation="ISO_19005_1" clause="6.7.5" testNumber="2"/>
            <description>The encoding attribute shall not be used in the header of an XMP packet.</description>
            <test>encoding == null</test>
            <references/>
        </rules>
        <rules object="PDExtGState">
            <id specifcation="ISO_19005_1" clause="6.2.8" testNumber="1"/>
            <description>An ExtGState dictionary shall not contain the TR key</description>
            <test>TR == null</test>
            <references/>
        </rules>
        <rules object="PDDocument">
            <id specifcation="ISO_19005_1" clause="6.6.2" testNumber="3"/>
            <description>The document catalog dictionary shall not include an AA entry for an additional-actions dictionary</description>
            <test>AA_size == 0</test>
            <references/>
        </rules>
        <rules object="CosDocument">
            <id specifcation="ISO_19005_1" clause="6.7.3" testNumber="1"/>
            <description>If a document information dictionary does appear at a document, then all of its entries that have analogous properties in predefined XMP schemas, shall also be embedded in the file in XMP form with equivalent values.</description>
            <test>doesInfoMatchXMP</test>
            <references>
                <references specification="ISO 19005-1:2005/Cor.1:2007/Cor.2:2011" clause="6.7.3"/>
            </references>
        </rules>
        <rules object="PDNamedAction">
            <id specifcation="ISO_19005_1" clause="6.6.1" testNumber="2"/>
            <description>Named actions other than NextPage, PrevPage, FirstPage, and LastPage shall not be permitted</description>
            <test>N == "NextPage" || N == "PrevPage" || N == "FirstPage" || N == "LastPage"</test>
            <references>
                <references specification="PDF 1.4 Reference" clause="8.5.3 - Named Actions - Table 8.45"/>
            </references>
        </rules>
        <rules object="PDFAExtensionSchema">
            <id specifcation="ISO_19005_1" clause="6.7.8" testNumber="5"/>
            <description>A PDF/A Property Schema namespace prefix is required to be "pdfaProperty".</description>
            <test>isPDFAPropertyPrefixCorrect</test>
            <references>
                <references specification="ISO 19005-1:2005/Cor.1:2007/Cor.2:2011" clause="6.7.8"/>
            </references>
        </rules>
        <rules object="CosXRef">
            <id specifcation="ISO_19005_1" clause="6.1.4" testNumber="2"/>
            <description>The xref keyword and the cross reference subsection header shall be separated by a single EOL marker</description>
            <test>xrefEOLMarkersComplyPDFA</test>
            <references/>
        </rules>
        <rules object="XMPPredefinedSchema">
            <id specifcation="ISO_19005_1" clause="6.7.9" testNumber="2"/>
            <description>All predefined schemas shall conform to XMP specification.</description>
            <test>unknownProperties == null</test>
            <references>
                <references specification="XMP Specification January 2004"/>
            </references>
        </rules>
        <rules object="PDDocument">
            <id specifcation="ISO_19005_1" clause="6.7.2" testNumber="1"/>
            <description>The document catalog dictionary of a conforming file shall contain the Metadata key.</description>
            <test>metadata_size == 1</test>
            <references/>
        </rules>
        <rules object="PDCIDFont">
            <id specifcation="ISO_19005_1" clause="6.3.3" testNumber="2"/>
            <description>For all Type 2 CIDFonts, the CIDFont dictionary shall contain a CIDToGIDMap entry that shall be a stream mapping
			from CIDs to glyph indices or the name Identity, as described in PDF Reference Table 5.13</description>
            <test>Subtype != "CIDFontType2" || CIDToGIDMap != null</test>
            <references>
                <references specification="PDF 1.4 Reference" clause="5.6.3 - Table 5.13"/>
            </references>
        </rules>
        <rules object="CosStream">
            <id specifcation="ISO_19005_1" clause="6.1.10" testNumber="1"/>
            <description>The LZWDecode filter shall not be permitted</description>
            <test>filters == null || filters.indexOf("LZWDecode") == -1</test>
            <references/>
        </rules>
        <rules object="PDSimpleFont">
            <id specifcation="ISO_19005_1" clause="6.3.2" testNumber="4"/>
            <description>All fonts used in a conforming file shall conform to the font specifications defined in PDF Reference 5.5.
			FirstChar - integer - (Required except for the standard 14 fonts) The first character code defined in the font's Widths array</description>
            <test>isStandard == true || FirstChar != null</test>
            <references>
                <references specification="PDF 1.4 Reference" clause="5.5.1 - Table 5.8"/>
                <references specification="PDF 1.4 Reference" clause="5.5.4 - Table 5.9"/>
            </references>
        </rules>
        <rules object="PDXObject">
            <id specifcation="ISO_19005_1" clause="6.2.4" testNumber="2"/>
            <description>An XObject dictionary (Image or Form) shall not contain the OPI key</description>
            <test>OPI_size == 0</test>
            <references/>
        </rules>
        <rules object="CosStream">
            <id specifcation="ISO_19005_1" clause="6.1.7" testNumber="3"/>
            <description>A stream object dictionary shall not contain the F, FFilter, or FDecodeParms keys</description>
            <test>F == null &amp;&amp; FFilter == null &amp;&amp; FDecodeParms == null</test>
            <references>
                <references specification="19005-1:2005/Cor.2:2011" clause="6.1.7"/>
            </references>
        </rules>
        <rules object="CosTrailer">
            <id specifcation="ISO_19005_1" clause="6.1.3" testNumber="2"/>
            <description>The keyword Encrypt shall not be used in the trailer dictionary</description>
            <test>isEncrypted != true</test>
            <references/>
        </rules>
        <rules object="PDAnnot">
            <id specifcation="ISO_19005_1" clause="6.5.3" testNumber="3"/>
            <description>An annotation dictionary shall not contain the C array or the IC array unless the colour space of the
			DestOutputProfile in the PDF/A-1 OutputIntent dictionary, defined in 6.2.2, is RGB</description>
            <test>(C_size == 0 &amp;&amp; IC_size == 0) || gOutputCS == "RGB "</test>
            <references/>
        </rules>
        <rules object="PDAnnot">
            <id specifcation="ISO_19005_1" clause="6.5.3" testNumber="4"/>
            <description>For all annotation dictionaries containing an AP key, the appearance dictionary that it defines as its value shall contain only the N key.
			If an annotation dictionary’s Subtype key has a value of Widget and its FT key has a value of Btn, the value of the N key shall be an appearance
			subdictionary; otherwise the value of the N key shall be an appearance stream.</description>
            <test>AP == null || ( AP == "N" &amp;&amp; ( N_type == "Stream" || (FT == "Btn" &amp;&amp; N_type == "Dict") ) )</test>
            <references>
                <references specification="ISO19005-1/Cor.2:2011" clause="6.5.3"/>
            </references>
        </rules>
        <rules object="PDInlineImage">
            <id specifcation="ISO_19005_1" clause="6.1.10" testNumber="2"/>
            <description>The LZWDecode filter shall not be permitted</description>
            <test>F == null || F.indexOf("LZW") == -1</test>
            <references/>
        </rules>
        <rules object="PDXForm">
            <id specifcation="ISO_19005_1" clause="6.2.6" testNumber="1"/>
            <description>A conforming file shall not contain any reference XObjects</description>
            <test>Ref_size == 0</test>
            <references/>
        </rules>
        <rules object="PDFAExtensionSchema">
            <id specifcation="ISO_19005_1" clause="6.7.8" testNumber="7"/>
            <description>A PDF/A ValueType Schema namespace prefix is required to be "pdfaType".</description>
            <test>isPDFATypePrefixCorrect</test>
            <references>
                <references specification="ISO 19005-1:2005/Cor.1:2007/Cor.2:2011" clause="6.7.8"/>
            </references>
        </rules>
        <rules object="PDDeviceCMYK">
            <id specifcation="ISO_19005_1" clause="6.2.3" testNumber="3"/>
            <description>DeviceCMYK may be used only if the file has a PDF/A-1 OutputIntent that uses a CMYK colour space</description>
            <test>gOutputCS != null &amp;&amp; gOutputCS == "CMYK"</test>
            <references/>
        </rules>
        <rules object="PDGroup">
            <id specifcation="ISO_19005_1" clause="6.4" testNumber="3"/>
            <description>A Group object with an S key with a value of Transparency shall not be included in a form XObject.
			A Group object with an S key with a value of Transparency shall not be included in a page dictionary</description>
            <test>S != "Transparency"</test>
            <references>
                <references specification="ISO19005-1:2005/Cor.2:2011" clause="6.4"/>
            </references>
        </rules>
        <rules object="CosIndirect">
            <id specifcation="ISO_19005_1" clause="6.1.8" testNumber="1"/>
            <description>The object number and generation number shall be separated by a single white-space character. The generation number and obj keyword
	shall be separated by a single white-space character. The object number and endobj keyword shall each be preceded by an EOL marker. The obj and endobj
	keywords shall each be followed by an EOL marker.</description>
            <test>spacingCompliesPDFA</test>
            <references/>
        </rules>
        <rules object="CosDocument">
            <id specifcation="ISO_19005_1" clause="6.1.3" testNumber="1"/>
            <description>The file trailer dictionary shall contain the ID keyword. The file trailer referred to is either the last trailer dictionary in a PDF file,
			as described in PDF Reference 3.4.4 and 3.4.5, or the first page trailer in a linearized PDF file, as described in PDF Reference F.2</description>
            <test>(isLinearized == true &amp;&amp; firstPageID != null) || ((isLinearized != true) &amp;&amp; lastID != null)</test>
            <references/>
        </rules>
        <rules object="PDCIDFont">
            <id specifcation="ISO_19005_1" clause="6.3.5" testNumber="3"/>
            <description>For all CIDFont subsets referenced within a conforming file, the font descriptor dictionary shall include a
			CIDSet stream identifying which CIDs are present in the embedded CIDFont file, as described in PDF Reference Table 5.20</description>
            <test>BaseFont.search(/[A-Z]{6}\+/) != 0 || CIDSet_size == 1</test>
            <references>
                <references specification="PDF 1.4 Reference" clause="5.5.3"/>
            </references>
        </rules>
        <rules object="Glyph">
            <id specifcation="ISO_19005_1" clause="6.3.6" testNumber="1"/>
            <description>For every font embedded in a conforming file, the glyph width information stored in the Widths entry of the
			font dictionary and in the embedded font program shall be consistent</description>
            <test>isWidthConsistent == true</test>
            <references/>
        </rules>
        <rules object="CosString">
            <id specifcation="ISO_19005_1" clause="6.1.12" testNumber="3"/>
            <description>Maximum length of a string (in bytes) is 65535</description>
            <test>value.length() &lt; 65536</test>
            <references>
                <references specification="PDF Reference 1.4" clause="Table C.1"/>
            </references>
        </rules>
        <rules object="PDAnnot">
            <id specifcation="ISO_19005_1" clause="6.5.2" testNumber="1"/>
            <description>Annotation types not defined in PDF Reference shall not be permitted. Additionally, the FileAttachment,
			Sound and Movie types shall not be permitted</description>
            <test>Subtype == "Text" || Subtype == "Link" || Subtype == "FreeText" || Subtype == "Line" ||
			Subtype == "Square" || Subtype == "Circle" || Subtype == "Highlight" || Subtype == "Underline" ||
			Subtype == "Squiggly" || Subtype == "StrikeOut" || Subtype == "Stamp" || Subtype == "Ink" ||
			Subtype == "Popup" || Subtype == "Widget" || Subtype == "PrinterMark" || Subtype == "TrapNet"</test>
            <references>
                <references specification="PDF 1.4 Reference" clause="8.4.5"/>
            </references>
        </rules>
        <rules object="PDFont">
            <id specifcation="ISO_19005_1" clause="6.3.2" testNumber="2"/>
            <description>All fonts used in a conforming file shall conform to the font specifications defined in PDF Reference 5.5.
			Subtype - name - (Required) The type of font; must be "Type1" for Type 1 fonts, "MMType1" for multiple master fonts, "TrueType" for TrueType fonts
			"Type3" for Type 3 fonts, "Type0" for Type 0 fonts and "CIDFontType0" or "CIDFontType2" for CID fonts</description>
            <test>Subtype == "Type1" || Subtype == "MMType1" || Subtype == "TrueType" || Subtype == "Type3" || Subtype == "Type0"
			|| Subtype == "CIDFontType0" || Subtype == "CIDFontType2"</test>
            <references>
                <references specification="PDF 1.4 Reference" clause="5.5.1 - Table 5.8"/>
                <references specification="PDF 1.4 Reference" clause="5.5.4 - Table 5.9"/>
                <references specification="PDF 1.4 Reference" clause="5.6.3 - Table 5.13"/>
                <references specification="PDF 1.4 Reference" clause="5.6.5 - Table 5.17"/>
            </references>
        </rules>
        <rules object="CosFileSpecification">
            <id specifcation="ISO_19005_1" clause="6.1.11" testNumber="1"/>
            <description>A file specification dictionary, as defined in PDF 3.10.2, shall not contain the EF key</description>
            <test>EF == null</test>
            <references>
                <references specification="PDF 1.4 Reference" clause="3.10.2"/>
            </references>
        </rules>
        <rules object="CosStream">
            <id specifcation="ISO_19005_1" clause="6.1.7" testNumber="2"/>
            <description>The stream keyword shall be followed either by a CARRIAGE RETURN (0Dh) and LINE FEED (0Ah) character sequence
			or by a single LINE FEED character. The endstream keyword shall be preceded by an EOL marker</description>
            <test>spacingCompliesPDFA</test>
            <references/>
        </rules>
        <rules object="PDAnnot">
            <id specifcation="ISO_19005_1" clause="6.5.3" testNumber="1"/>
            <description>An annotation dictionary shall not contain the CA key with a value other than 1.0</description>
            <test>CA == null || CA == 1.0</test>
            <references/>
        </rules>
        <rules object="ICCInputProfile">
            <id specifcation="ISO_19005_1" clause="6.2.3" testNumber="1"/>
            <description>All ICCBased colour spaces shall be embedded as ICC profile streams as described in PDF Reference 4.5</description>
            <test>(deviceClass == "prtr" || deviceClass == "mntr" || deviceClass == "scnr" || deviceClass == "spac") &amp;&amp;
			(colorSpace == "RGB " || colorSpace == "CMYK" || colorSpace == "GRAY" || colorSpace == "LAB ") &amp;&amp; version &lt;= 2.3</test>
            <references>
                <references specification="PDF 1.4 Reference" clause="4.5.4, ICCBased Color Spaces"/>
            </references>
        </rules>
        <rules object="PDFAIdSchema">
            <id specifcation="ISO_19005_1" clause="6.7.11" testNumber="2"/>
            <description>The PDF/A version and conformance level of a file shall be specified using the PDF/A Identification extension schema.</description>
            <test>part == 1</test>
            <references/>
        </rules>
        <rules object="PDDeviceRGB">
            <id specifcation="ISO_19005_1" clause="6.2.3" testNumber="2"/>
            <description>DeviceRGB may be used only if the file has a PDF/A-1 OutputIntent that uses an RGB colour space</description>
            <test>gOutputCS != null &amp;&amp; gOutputCS == "RGB "</test>
            <references/>
        </rules>
        <rules object="PDExtGState">
            <id specifcation="ISO_19005_1" clause="6.4" testNumber="6"/>
            <description>The following keys, if present in an ExtGState object, shall have the values shown: CA - 1.0</description>
            <test>ca == null || ca - 1.0 &lt; 0.000001 &amp;&amp; ca - 1.0 &gt; -0.000001</test>
            <references/>
        </rules>
        <rules object="CosDocument">
            <id specifcation="ISO_19005_1" clause="6.1.2" testNumber="2"/>
            <description>The file header line shall be immediately followed by a comment consisting of a % character followed by at
			least four characters, each of whose encoded byte values shall have a decimal value greater than 127</description>
            <test>binaryHeaderComplyPDFA</test>
            <references/>
        </rules>
        <rules object="PDFont">
            <id specifcation="ISO_19005_1" clause="6.3.4" testNumber="1"/>
            <description>The font programs for all fonts used within a conforming file shall be embedded within that file, as defined in PDF Reference 5.8,
			except when the fonts are used exclusively with text rendering mode 3</description>
            <test>Subtype == "Type3" || Subtype == "Type0" || fontFile_size == 1</test>
            <references>
                <references specification="PDF 1.4 Reference" clause="5.8"/>
            </references>
        </rules>
        <rules object="CosDocument">
            <id specifcation="ISO_19005_1" clause="6.1.2" testNumber="1"/>
            <description>The % character of the file header shall occur at byte offset 0 of the file.
			The first line of a PDF file is a header identifying the version of the PDF specification to which the file conforms</description>
            <test>pdfHeaderCompliesPDFA</test>
            <references>
                <references specification="PDF 1.4 Reference" clause="3.4.1"/>
            </references>
        </rules>
        <rules object="PDExtGState">
            <id specifcation="ISO_19005_1" clause="6.4" testNumber="4"/>
            <description>The following keys, if present in an ExtGState object, shall have the values shown: BM - Normal or Compatible</description>
            <test>BM == null || BM == "Normal" || BM == "Compatible"</test>
            <references/>
        </rules>
        <rules object="PDXImage">
            <id specifcation="ISO_19005_1" clause="6.2.4" testNumber="1"/>
            <description>An Image dictionary shall not contain the Alternates key</description>
            <test>Alternates_size == 0</test>
            <references/>
        </rules>
        <rules object="CosDocument">
            <id specifcation="ISO_19005_1" clause="6.1.11" testNumber="2"/>
            <description>A file's name dictionary, as defined in PDF Reference 3.6.3, shall not contain the EmbeddedFiles key</description>
            <test>EmbeddedFiles_size == 0</test>
            <references>
                <references specification="PDF 1.4 Reference" clause="3.6.3"/>
            </references>
        </rules>
        <rules object="XMPCustomSchema">
            <id specifcation="ISO_19005_1" clause="6.7.8" testNumber="2"/>
            <description>All extension schemas used in a conforming file shall have their descriptions embedded within that file in the metadata stream.</description>
            <test>isDefinedInThisPackage</test>
            <references>
                <references specification="ISO 19005-1:2005/Cor.1:2007/Cor.2:2011" clause="6.7.8"/>
            </references>
        </rules>
        <rules object="CosDocument">
            <id specifcation="ISO_19005_1" clause="6.1.12" testNumber="7"/>
            <description>Maximum number of indirect objects in a PDF file is 8,388,607</description>
            <test>nrIndirects &lt;= 8388607</test>
            <references>
                <references specification="PDF Reference 1.4" clause="Table C.1"/>
            </references>
        </rules>
        <rules object="ICCOutputProfile">
            <id specifcation="ISO_19005_1" clause="6.2.2" testNumber="1"/>
            <description>A PDF/A-1 OutputIntent is an OutputIntent dictionary, as defined by PDF Reference 9.10.4, that is included in the file's OutputIntents
	array and has GTS_PDFA1 as the value of its S key and a valid ICC profile stream as the value its DestOutputProfile key</description>
            <test>(deviceClass == "prtr" || deviceClass == "mntr") &amp;&amp; (colorSpace == "RGB " || colorSpace == "CMYK" || colorSpace == "GRAY") &amp;&amp; version &lt;= 2.3</test>
            <references>
                <references specification="PDF 1.4 Reference" clause="9.4.10"/>
            </references>
        </rules>
        <rules object="ICCProfile">
            <id specifcation="ISO_19005_1" clause="6.2.3" testNumber="5"/>
            <description>The number of color components in the color space described by the ICC profile data must match the number of components actually in the ICC profile.
			As of PDF 1.4, N must be 1, 3, or 4</description>
            <test>N != null &amp;&amp; ((N == 1 &amp;&amp; colorSpace == "GRAY") || (N == 3 &amp;&amp; (colorSpace == "RGB " || colorSpace == "LAB ")) || (N == 4 &amp;&amp; colorSpace == "CMYK"))</test>
            <references>
                <references specification="PDF 1.4 Reference" clause="4.5.4, Table 4.16"/>
            </references>
        </rules>
        <rules object="CosReal">
            <id specifcation="ISO_19005_1" clause="6.1.12" testNumber="2"/>
            <description>Absolute real value must be less than or equal to 32767.0</description>
            <test>(realValue &gt;= -32767.0) &amp;&amp; (realValue &lt;= 32767.0)</test>
            <references>
                <references specification="PDF Reference 1.4" clause="Table C.1"/>
            </references>
        </rules>
        <rules object="PDFAIdSchema">
            <id specifcation="ISO_19005_1" clause="6.7.11" testNumber="4"/>
            <description>The property "corr" is not specified in PDF/A Identification Schema in PDF/A-1 specification.</description>
            <test>corr == null</test>
            <references/>
        </rules>
        <rules object="Op_q_gsave">
            <id specifcation="ISO_19005_1" clause="6.1.12" testNumber="8"/>
            <description>Maximum depth of graphics state nesting by q and Q operators is 28</description>
            <test>nestingLevel &lt;= 28</test>
            <references>
                <references specification="PDF Reference 1.4" clause="Table C.1"/>
            </references>
        </rules>
        <rules object="XMPCustomSchema">
            <id specifcation="ISO_19005_1" clause="6.7.8" testNumber="1"/>
            <description>All extension schemas used in a conforming file shall have their descriptions embedded within that file in the metadata stream.</description>
            <test>isDefinitionCorrect</test>
            <references>
                <references specification="ISO 19005-1:2005/Cor.1:2007/Cor.2:2011" clause="6.7.8"/>
            </references>
        </rules>
        <rules object="CosDocument">
            <id specifcation="ISO_19005_1" clause="6.1.3" testNumber="4"/>
            <description>In a linearized PDF, if the ID keyword is present in both the first page trailer dictionary
			and the last trailer dictionary, the value to both instances of the ID keyword shall be identical</description>
            <test>(isLinearized != true)|| lastID == null || (firstPageID == lastID)</test>
            <references>
                <references specification="ISO 19005-1:2005/Cor.2:2011" clause="6.1.3"/>
            </references>
        </rules>
        <rules object="PDExtGState">
            <id specifcation="ISO_19005_1" clause="6.4" testNumber="1"/>
            <description>If an SMask key appears in an ExtGState dictionary, its value shall be None</description>
            <test>SMask == null || SMask == "None"</test>
            <references/>
        </rules>
        <rules object="TrueTypeFontProgram">
            <id specifcation="ISO_19005_1" clause="6.3.7" testNumber="3"/>
            <description>Font programs' "cmap" tables for all symbolic TrueType fonts shall contain exactly one encoding</description>
            <test>isSymbolic == false || nrCmaps == 1</test>
            <references>
                <references specification="ISO19005-1:2005/Cor.2:2011" clause="6.3.7"/>
            </references>
        </rules>
        <rules object="PDAnnot">
            <id specifcation="ISO_19005_1" clause="6.5.3" testNumber="2"/>
            <description>An annotation dictionary shall contain the F key. The F key’s Print flag bit shall be set to 1 and its Hidden,
			Invisible and NoView flag bits shall be set to 0</description>
            <test>F != null &amp;&amp; (F &amp; 4) == 4 &amp;&amp; (F &amp; 1) == 0 &amp;&amp; (F &amp; 2) == 0 &amp;&amp; (F &amp; 32) == 0</test>
            <references/>
        </rules>
        <rules object="CosStream">
            <id specifcation="ISO_19005_1" clause="6.1.7" testNumber="1"/>
            <description>The value of the Length key specified in the stream dictionary shall match the number of bytes in the file
			following the LINE FEED character after the stream keyword and preceding the EOL marker before the endstream keyword</description>
            <test>isLengthCorrect</test>
            <references/>
        </rules>
        <rules object="PDAcroForm">
            <id specifcation="ISO_19005_1" clause="6.9" testNumber="1"/>
            <description>The NeedAppearances flag of the interactive form dictionary shall either not be present or shall be false</description>
            <test>NeedAppearances == null || NeedAppearances == false</test>
            <references/>
        </rules>
        <rules object="PDXObject">
            <id specifcation="ISO_19005_1" clause="6.2.7" testNumber="1"/>
            <description>A conforming file shall not contain any PostScript XObjects</description>
            <test>Subtype != "PS"</test>
            <references/>
        </rules>
        <rules object="CosString">
            <id specifcation="ISO_19005_1" clause="6.1.6" testNumber="2"/>
            <description>All non-white-space characters in hexadecimal strings shall be in the range 0 to 9, A to F or a to f</description>
            <test>(isHex != true) || isHexSymbols</test>
            <references/>
        </rules>
        <rules object="PDType0Font">
            <id specifcation="ISO_19005_1" clause="6.3.3" testNumber="1"/>
            <description>For any given composite (Type 0) font referenced within a conforming file, the CIDSystemInfo entries of its
			CIDFont and CMap dictionaries shall be compatible</description>
            <test>areRegistryOrderingCompatible == true</test>
            <references>
                <references specification="PDF 1.4 Reference" clause="5.6.2"/>
            </references>
        </rules>
        <rules object="CosInteger">
            <id specifcation="ISO_19005_1" clause="6.1.12" testNumber="1"/>
            <description>Largest Integer value is 2,147,483,647. Smallest integer value is -2,147,483,648</description>
            <test>(intValue &lt;= 2147483647) &amp;&amp; (intValue &gt;= -2147483648)</test>
            <references>
                <references specification="PDF Reference 1.4" clause="Table C.1"/>
            </references>
        </rules>
        <rules object="PDFAExtensionSchema">
            <id specifcation="ISO_19005_1" clause="6.7.8" testNumber="6"/>
            <description>A PDF/A Schema Description Schema namespace prefix is required to be "pdfaSchema".</description>
            <test>isPDFASchemaPrefixCorrect</test>
            <references>
                <references specification="ISO 19005-1:2005/Cor.1:2007/Cor.2:2011" clause="6.7.8"/>
            </references>
        </rules>
        <rules object="PDSimpleFont">
            <id specifcation="ISO_19005_1" clause="6.3.2" testNumber="6"/>
            <description>All fonts used in a conforming file shall conform to the font specifications defined in PDF Reference 5.5.
			Widths - array - (Required except for the standard 14 fonts; indirect reference preferred) An array of (LastChar − FirstChar + 1) widths</description>
            <test>isStandard == true || (Widths_size != null &amp;&amp; Widths_size == LastChar - FirstChar + 1)</test>
            <references>
                <references specification="PDF 1.4 Reference" clause="5.5.1 - Table 5.8"/>
                <references specification="PDF 1.4 Reference" clause="5.5.4 - Table 5.9"/>
            </references>
        </rules>
        <rules object="PDAnnot">
            <id specifcation="ISO_19005_1" clause="6.9" testNumber="2"/>
            <description>A Widget annotation dictionary or Field dictionary shall not contain the A or AA keys</description>
            <test>Subtype != "Widget" || (A_size == 0 &amp;&amp; AA_size == 0)</test>
            <references/>
        </rules>
        <rules object="PDAnnot">
            <id specifcation="ISO_19005_1" clause="6.6.1" testNumber="3"/>
            <description>Interactive form fields shall not perform actions of any type</description>
            <test>Subtype != "Widget" || A_size == 0</test>
            <references/>
        </rules>
        <rules object="PDXForm">
            <id specifcation="ISO_19005_1" clause="6.2.5" testNumber="1"/>
            <description>A form XObject dictionary shall not contain the Subtype2 key with a value of PS or the PS key</description>
            <test>(Subtype2 == null || Subtype2 != "PS") &amp;&amp; PS_size == 0</test>
            <references/>
        </rules>
        <rules object="PDSimpleFont">
            <id specifcation="ISO_19005_1" clause="6.3.2" testNumber="5"/>
            <description>All fonts used in a conforming file shall conform to the font specifications defined in PDF Reference 5.5.
			FirstChar - integer - (Required except for the standard 14 fonts) The first character code defined in the font's Widths array</description>
            <test>isStandard == true || LastChar != null</test>
            <references>
                <references specification="PDF 1.4 Reference" clause="5.5.1 - Table 5.8"/>
                <references specification="PDF 1.4 Reference" clause="5.5.4 - Table 5.9"/>
            </references>
        </rules>
        <rules object="PDExtGState">
            <id specifcation="ISO_19005_1" clause="6.2.8" testNumber="2"/>
            <description>An ExtGState dictionary shall not contain the TR2 key with a value other than Default</description>
            <test>TR2 == null || TR2 == "Default"</test>
            <references/>
        </rules>
        <rules object="CosString">
            <id specifcation="ISO_19005_1" clause="6.1.6" testNumber="1"/>
            <description>Hexadecimal strings shall contain an even number of non-white-space characters</description>
            <test>(isHex != true) || hexCount % 2 == 0</test>
            <references/>
        </rules>
        <rules object="PDFAExtensionSchema">
            <id specifcation="ISO_19005_1" clause="6.7.8" testNumber="4"/>
            <description>A PDF/A Field Schema namespace prefix is required to be "pdfaField".</description>
            <test>isPDFAFieldPrefixCorrect</test>
            <references>
                <references specification="ISO 19005-1:2005/Cor.1:2007/Cor.2:2011" clause="6.7.8"/>
            </references>
        </rules>
        <rules object="PDFont">
            <id specifcation="ISO_19005_1" clause="6.3.2" testNumber="1"/>
            <description>All fonts used in a conforming file shall conform to the font specifications defined in PDF Reference 5.5.
	Type - name - (Required) The type of PDF object that this dictionary describes; must be Font for a font dictionary</description>
            <test>Type == "Font"</test>
            <references>
                <references specification="PDF 1.4 Reference" clause="5.5.1 - Table 5.8"/>
                <references specification="PDF 1.4 Reference" clause="5.5.4 - Table 5.9"/>
                <references specification="PDF 1.4 Reference" clause="5.6.3 - Table 5.13"/>
                <references specification="PDF 1.4 Reference" clause="5.6.5 - Table 5.17"/>
            </references>
        </rules>
        <rules object="PDAnnot">
            <id specifcation="ISO_19005_1" clause="6.6.2" testNumber="1"/>
            <description>A Widget annotation dictionary shall not include an AA entry for an additional-actions dictionary</description>
            <test>Subtype != "Widget" || AA_size == 0</test>
            <references/>
        </rules>
        <rules object="CosXRef">
            <id specifcation="ISO_19005_1" clause="6.1.4" testNumber="1"/>
            <description>In a cross reference subsection header the starting object number and the range shall be separated by a single SPACE character (20h)</description>
            <test>xrefHeaderSpacingsComplyPDFA</test>
            <references/>
        </rules>
        <rules object="Op_Undefined">
            <id specifcation="ISO_19005_1" clause="6.2.10" testNumber="1"/>
            <description>A content stream shall not contain any operators not defined in PDF Reference
			even if such operators are bracketed by the BX/EX compatibility operators</description>
            <test>false</test>
            <references/>
        </rules>
        <rules object="PDFAExtensionSchema">
            <id specifcation="ISO_19005_1" clause="6.7.8" testNumber="3"/>
            <description>The required PDF/A Extension Schema namespace prefix is pdfaExtension.</description>
            <test>prefix == "pdfaExtension"</test>
            <references>
                <references specification="ISO 19005-1:2005/Cor.1:2007/Cor.2:2011" clause="6.7.8"/>
            </references>
        </rules>
    </rules>
    <variables>
        <variables name="gOutputCS" object="ICCOutputProfile">
            <defaultValue>null</defaultValue>
            <value>S == "GTS_PDFA1" ? colorSpace : gOutputCS</value>
        </variables>
        <variables name="gOutputProfileRef" object="PDOutputIntent">
            <defaultValue>null</defaultValue>
            <value>gOutputProfileRef == null ? destOutputProfileRef : gOutputProfileRef</value>
        </variables>
    </variables>
</ns2:profile>
